            const { writeFile, mkdir } = require('fs').promises;
  
            // Define an async function
            async function updatePRAndWriteChangelog() {
              const rootModule = process.env.ROOT_MODULE;
              const changelog_file = process.env.CHANGELOG;
              const { owner, repo } = context.repo;
            
              // Get PR information
              const { data: prInfo } = await github.rest.pulls.get({
                owner,
                repo,
                pull_number: context.issue.number,
              });
            
              // Check if the PR body is empty
              if (!prInfo.body || prInfo.body.trim() === "") {
                console.log("PR body is empty. Adding default changelog message.");
                prInfo.body = "Changelog: Please provide a changelog entry for this PR.";
              }
            
              // Update the PR body with the appended changelog
              const updatedBody = `${prInfo.body.trim()}
            
            ## Changelog
            \`\`\`
            Your changelog content here
            \`\`\``;
            
              await github.rest.pulls.update({
                owner,
                repo,
                pull_number: context.issue.number,
                body: updatedBody,
              });
            
              // Extract the 'Changelog' section from the updated PR body
              const changelogSection = updatedBody.match(/## Changelog[\r\n]+```([\s\S]*?)```/);
              const changelogEntry = changelogSection ? changelogSection[1].trim() : null;
            
              if (!changelogEntry) {
                throw new Error("'Changelog' section not found in PR body! Please add it back.");
              }
              if (changelogEntry.match(/^TODO:/m)) {
                throw new Error("'Changelog' section needs proper text, instead of 'TODO'");
              }
            
              console.log("Found PR body:");
              console.log(updatedBody);
              console.log("Extracted Changelog Entry:", changelogEntry);

              // Ensure the directory exists
              const outputPath = "output/";
              await mkdir(outputPath, { recursive: true });
            
              // Write the changelog entry to a file
              //"terraform/${rootModule}/output/changelog.md",
              console.log(process.cwd());
              await writeFile(
                "terraform/${{ inputs.rootModule }}/output/changelog.md"
                `
            * PR [#${prInfo.number}](${prInfo.html_url}) - ${prInfo.title}
            \`\`\`
            ${changelogEntry}
            \`\`\`
            `.trimLeft(),
                { encoding: "utf-8" }
              );

              console.log("Changelog written successfully");
            }
            
            // Call the async function
            updatePRAndWriteChangelog().catch((error) => {
              console.error("Unhandled error:", error.message);
            });

